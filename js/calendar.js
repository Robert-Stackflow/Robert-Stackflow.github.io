!function(t){var e=function(e,a,n){var r,l=new Date,o=l.getDate(),s=l.getMonth(),p=l.getFullYear(),u=o,d=s,i=p,c=n,f=null,h=null,g={posts:[],prev:null,next:null},v="en";(r=e)&&"undefined"!=typeof calLanguages&&calLanguages[r]&&(v=r);var y=t.extend({},t.fn.aCalendar.defaults,"undefined"==typeof calLanguages?{}:calLanguages[v],a);function m(){d<11?d++:(d=0,i++),T()}function x(){d>0?d--:(d=11,i--),T()}function M(t){t&&(i=t.getFullYear(),d=t.getMonth(),T())}function k(){y.single?null!=y.url&&""!=y.url&&(null===f&&t.ajax({url:y.url,async:!1,success:function(t){f=t,D(Object.keys(f))}}),null!==f&&w()&&(g.posts=f[i+"-"+(d+1)])):function(){null===h&&t.ajax({url:y.root+"list.json",async:!1,success:function(t){D(t)}});w()&&t.ajax({url:y.root+i+"-"+(d+1)+".json",async:!1,success:function(t){g.posts=t}})}()}function D(t){h=t.map((function(t){var e=t.split("-");return new Date(Date.UTC(+e[0],+e[1]-1))}))}function w(){var t=Date.UTC(i,d);if(null===h||0===h.length)return!1;if(0===g.posts.length&&(null===g.prev&&null!==g.next&&g.next.getTime()>t||null===g.next&&null!==g.prev&&g.prev.getTime()<t))return!1;g.posts=[];for(var e=0;e<h.length;e++){var a=h[e].getTime();if(t===a)return g.prev=0===e?null:h[e-1],g.next=e===h.length-1?null:h[e+1],!0;if(t<a){g.prev=0===e?null:h[e-1],g.next=h[e];break}g.prev=h[e],g.next=null}return!1}function C(t,e){var a={"LMM+":y.months[t.getMonth()],"MM+":t.getMonth()+1};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,"LMM+"===n?a[n]:("00"+a[n]).substr((""+a[n]).length)));return e}function T(){k();var e=new Date(i,d,1).getDay()-y.weekOffset;e<=0&&(e=6- -1*(e+1));var a=new Date(i,d+1,0).getDate(),n=new Date(i,d,0).getDate()-e+1,r=t("<div/>").addClass("cal-head"),l=t("<div/>"),o=t("<div/>"),f=t("<div/>").addClass("cal-title");o.html(y.headArrows.previous),l.html(y.headArrows.next),curDate=new Date(Date.UTC(i,d)),0===g.posts.length?f.html(C(curDate,y.titleFormat)):(cTitleLink=t("<a/>").attr("href",C(curDate,y.titleLinkFormat)).attr("title",C(curDate,y.postsMonthTip)).html(C(curDate,y.titleFormat)),f.html(cTitleLink)),o.on("click",x),l.on("click",m),r.append(o),r.append(f),r.append(l);for(var h=t("<table/>").addClass("cal"),v=y.weekOffset,D=t("<thead/>"),w=t("<tr/>"),T=0;T<7;T++){v>6&&(v=0);var L=t("<th/>").attr("scope","col").attr("title",y.dayOfWeek[v]);L.html(y.dayOfWeekShort[v]),w.append(L),v++}D.append(w),h.append(D);var F=t("<tfoot/>"),j=t("<tr/>"),O=t("<td/>").attr("colspan",3),b=t("<td/>").html("&nbsp;"),A=t("<td/>").attr("colspan",3);g.prev&&O.html(y.footArrows.previous+y.months[g.prev.getMonth()]).addClass("cal-foot").attr("title",C(g.prev,y.postsMonthTip)),g.next&&A.html(y.months[g.next.getMonth()]+y.footArrows.next).addClass("cal-foot").attr("title",C(g.next,y.postsMonthTip)),O.on("click",(function(){M(g.prev)})),A.on("click",(function(){M(g.next)})),j.append(O),j.append(b),j.append(A),F.append(j);var W=t("<tbody/>"),$=1,E=1;for(T=0;T<6;T++){for(var R=t("<tr/>"),S=0;S<7;S++){var U=t("<td/>");if(7*T+S<e)U.addClass("cal-gray"),U.html(n++);else if($<=a){$==u&&s==d&&p==i&&U.addClass("cal-today");for(var Y={num:0,keys:[]},z=0;z<g.posts.length;z++){new Date(Date.parse(g.posts[z].date)).getDate()==$&&(Y.keys[Y.num++]=z)}if(0!==Y.num){var N=Y.keys[0],Q=t("<a>").attr("href",g.posts[N].link).attr("title",g.posts[N].title).html($++);U.append(Q)}else U.html($++)}else U.addClass("cal-gray"),U.html(E++);R.append(U)}W.append(R)}h.append(D),h.append(F),h.append(W),t(c).html(r),t(c).append(h)}return"/"!==y.root[0]&&(y.root="/"+y.root),"/"!==y.root[y.root.length-1]&&(y.root+="/"),T()};t.fn.aCalendar=function(a,n){return this.each((function(){return e(a,n,t(this))}))},t.fn.aCalendar.defaults={months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeekShort:["日","一","二","三","四","五","六"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],postsMonthTip:"yyyy年LMM发布的文章",titleFormat:"yyyy年LMM",titleLinkFormat:"/archives/yyyy/MM/",headArrows:{previous:'<span class="cal-prev"></span>',next:'<span class="cal-next"></span>'},footArrows:{previous:"« ",next:" »"},weekOffset:0,single:!0,root:"/calendar/",url:"/calendar.json"}}(jQuery),$(document).ready((function(){$("#calendar").aCalendar("zh-CN")}));