!function(t){var e=function(e,a,n){var l,r=new Date,s=r.getDate(),o=r.getMonth(),p=r.getFullYear(),u=s,d=o,i=p,c=n,f=null,h=null,g={posts:[],prev:null,next:null},y="en";(l=e)&&"undefined"!=typeof calLanguages&&calLanguages[l]&&(y=l);var v=t.extend({},t.fn.aCalendar.defaults,"undefined"==typeof calLanguages?{}:calLanguages[y],a);function m(){d<11?d++:(d=0,i++),T()}function x(){d>0?d--:(d=11,i--),T()}function M(t){t&&(i=t.getFullYear(),d=t.getMonth(),T())}function k(){v.single?null!=v.url&&""!=v.url&&(null===f&&t.ajax({url:v.url,async:!1,success:function(t){f=t,D(Object.keys(f))}}),null!==f&&w()&&(g.posts=f[i+"-"+(d+1)])):function(){null===h&&t.ajax({url:v.root+"list.json",async:!1,success:function(t){D(t)}});w()&&t.ajax({url:v.root+i+"-"+(d+1)+".json",async:!1,success:function(t){g.posts=t}})}()}function D(t){h=t.map((function(t){var e=t.split("-");return new Date(Date.UTC(+e[0],+e[1]-1))}))}function w(){var t=Date.UTC(i,d);if(null===h||0===h.length)return!1;if(0===g.posts.length&&(null===g.prev&&null!==g.next&&g.next.getTime()>t||null===g.next&&null!==g.prev&&g.prev.getTime()<t))return!1;g.posts=[];for(var e=0;e<h.length;e++){var a=h[e].getTime();if(t===a)return g.prev=0===e?null:h[e-1],g.next=e===h.length-1?null:h[e+1],!0;if(t<a){g.prev=0===e?null:h[e-1],g.next=h[e];break}g.prev=h[e],g.next=null}return!1}function C(t,e){var a={"LMM+":v.months[t.getMonth()],"MM+":t.getMonth()+1};for(var n in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,"LMM+"===n?a[n]:("00"+a[n]).substr((""+a[n]).length)));return e}function T(){k();var e=new Date(i,d,1).getDay()-v.weekOffset;e<=0&&(e=6- -1*(e+1));var a=new Date(i,d+1,0).getDate(),n=new Date(i,d,0).getDate()-e+1,l=t("<div/>").addClass("cal-head"),r=t("<div/>"),s=t("<div/>"),f=t("<div/>").addClass("cal-title");s.html(v.headArrows.previous),r.html(v.headArrows.next),curDate=new Date(Date.UTC(i,d)),0===g.posts.length?f.html(C(curDate,v.titleFormat)):(cTitleLink=t("<a/>").attr("href",C(curDate,v.titleLinkFormat)).attr("title",C(curDate,v.postsMonthTip)).html(C(curDate,v.titleFormat)),f.html(cTitleLink)),s.on("click",x),r.on("click",m),l.append(s),l.append(f),l.append(r);for(var h=t("<table/>").addClass("cal"),y=v.weekOffset,D=t("<thead/>"),w=t("<tr/>"),T=0;T<7;T++){y>6&&(y=0);var L=t("<th/>").attr("class","cal_week").attr("scope","col").attr("title",v.dayOfWeek[y]);L.html(v.dayOfWeekShort[y]),w.append(L),y++}D.append(w),h.append(D);var F=t("<tfoot/>"),j=t("<tr/>"),O=t("<td/>").attr("colspan",3),b=t("<td/>").html("&nbsp;"),A=t("<td/>").attr("colspan",3);g.prev&&O.html(v.footArrows.previous+v.months[g.prev.getMonth()]).addClass("cal-foot").attr("title",C(g.prev,v.postsMonthTip)),g.next&&A.html(v.months[g.next.getMonth()]+v.footArrows.next).addClass("cal-foot").attr("title",C(g.next,v.postsMonthTip)),O.on("click",(function(){M(g.prev)})),A.on("click",(function(){M(g.next)})),j.append(O),j.append(b),j.append(A),F.append(j);var W=t("<tbody/>"),$=1,E=1;for(T=0;T<6;T++){for(var R=t("<tr/>"),S=0;S<7;S++){var U=t("<td/>");if(7*T+S<e)U.addClass("cal-gray"),U.html(n++);else if($<=a){$==u&&o==d&&p==i?U.addClass("cal-today"):U.addClass("cal-ntoday");for(var Y={num:0,keys:[]},z=0;z<g.posts.length;z++){new Date(Date.parse(g.posts[z].date)).getDate()==$&&(Y.keys[Y.num++]=z)}if(0!==Y.num){var N=Y.keys[0],Q=t("<a>").attr("href",g.posts[N].link).attr("title",g.posts[N].title).html($++);U.append(Q)}else if($==u&&o==d&&p==i){Q=t("<a>").html($++);U.append(Q)}else U.html($++)}else U.addClass("cal-gray"),U.html(E++);R.append(U)}W.append(R)}h.append(D),h.append(F),h.append(W),t(c).html(l),t(c).append(h)}return"/"!==v.root[0]&&(v.root="/"+v.root),"/"!==v.root[v.root.length-1]&&(v.root+="/"),T()};t.fn.aCalendar=function(a,n){return this.each((function(){return e(a,n,t(this))}))},t.fn.aCalendar.defaults={months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeekShort:["日","一","二","三","四","五","六"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],postsMonthTip:"yyyy年LMM发布的文章",titleFormat:"yyyy年LMM",titleLinkFormat:"/archives/yyyy/MM/",headArrows:{previous:'<span class="cal-prev"></span>',next:'<span class="cal-next"></span>'},footArrows:{previous:"« ",next:" »"},weekOffset:0,single:!0,root:"/calendar/",url:"/calendar.json"}}(jQuery),$(document).ready((function(){$("#calendar").aCalendar("zh-CN")}));